/**
 * functions/prompts/title-generation.js
 * 제목 생성 프롬프트 템플릿
 */

'use strict';

/**
 * 본문 내용 기반 제목 생성 프롬프트를 빌드합니다
 * @param {Object} params - 프롬프트 빌드에 필요한 파라미터
 * @param {string} params.contentPreview - 본문 미리보기 (HTML 태그 제거됨)
 * @param {string} params.backgroundText - 배경정보 텍스트
 * @param {string} params.topic - 주제
 * @param {string} params.fullName - 작성자 이름
 * @param {Array<string>} params.keywords - 필수 키워드 목록
 * @returns {string} 완성된 제목 생성 프롬프트
 */
function buildTitlePrompt({ contentPreview, backgroundText, topic, fullName, keywords }) {
  return `[제목 생성 가이드]
너는 본문 내용의 핵심을 담아, 아래 원칙과 예시를 깊이 학습하여 가장 효과적인 제목을 만들어야 한다.

---

[✅ 제목 생성 핵심 원칙]
1. **키워드 전진 배치**: 가장 중요한 핵심 키워드(지역명, 정책명, 인물 등)를 제목의 가장 앞부분에 배치하여 검색 노출과 독자의 주목도를 극대화하라.
2. **숫자로 증명**: 예산, 기간, 통계, D-day, N가지 방법 등 구체적인 숫자를 활용하여 성과를 증명하고 신뢰도를 높여라.
3. **문제 해결 제시**: 독자(주민)가 겪는 문제(Pain Point)를 직접 언급하고, 그것을 어떻게 해결해 줄 수 있는지 명확하게 보여주어라. (예: 'OOO 문제, OOO으로 해결!')
4. **호기심 자극**: '왜 OOO일까?', '~해도 괜찮을까?' 등 질문을 던지거나, 통념을 뒤집는 반전 효과를 활용하여 독자의 클릭을 유도하라.
5. **가치/감성 포함**: '약속', '눈물', '반드시', '우리' 등 긍정적/부정적 감성어를 활용하여 독자의 공감대를 형성하고 지지를 유도하라.

---

[👍 좋은 제목 예시 (Few-shot)]
- "신월동 상습 침수 문제, 빗물 저류 시설 확충(예산 120억)으로 해결하겠습니다."
- "주민 여러분과의 약속, 드디어 해냈습니다! 국비 50억 확보로 OOO 체육센터 건립 확정."
- "시민의 혈세 100억, 정말 '이곳'에 쓰는 것이 최선입니까?"
- "지난 5년간 아동 병원 30% 급감, 우리 아이들이 갈 곳이 없습니다. (데이터 분석)"
- "정치를 시작했던 그날의 초심을 떠올리게 해준 한 통의 손편지."

---

[👎 나쁜 제목 예시 (절대 금지)]
- "미래를 위한 정책 제안" (Critique: 너무 추상적이고 구체적인 내용이 없음. 무슨 정책인지 알 수 없음.)
- "최선을 다해 뛰었습니다" (Critique: 구체적인 성과(숫자, 결과)가 없어 신뢰도가 떨어짐.)
- "OOO는 각성하라" (Critique: 근거 없는 비난이며, 감정적인 구호에 그쳐 논리적이지 않음.)

---

[본문 정보]
본문 내용 (일부):
${contentPreview}

배경정보 핵심:
${backgroundText.substring(0, 500)}

주제: ${topic}
작성자: ${fullName}
필수 포함 키워드: ${keywords.slice(0, 5).join(', ')}

---

[최종 요구사항]
1. 제목 길이: 20-30자 (엄수)
2. 본문의 핵심 내용과 감정 톤을 정확히 반영
3. 필수 키워드 중 최소 1개 이상 자연스럽게 포함
4. 위 5가지 핵심 원칙 중 본문에 가장 적합한 원칙들을 조합하여 활용
5. 좋은 예시의 패턴을 학습하되, 나쁜 예시의 오류는 절대 반복하지 말 것

제목만 출력하세요:`;
}

module.exports = {
  buildTitlePrompt,
};
